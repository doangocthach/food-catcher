{"ast":null,"code":"var pushToComboList=function pushToComboList(comboList,texture,indexCombo,comboSize,width,height){comboList.push({tex:texture,x:Math.random()>0.5?width*1.5/4:width*2.5/4,y:Math.random()*(height*2/4-height*2.5/4)+height*2.5/4,width:comboSize[indexCombo].width,height:comboSize[indexCombo].height,infos:{stateTime:0,scale:0,opacity:0}});};var createBannerComboRenderSystem=function createBannerComboRenderSystem(){var comboList=[];var combo1,combo2,combo3;var comboSize=[];return{init:function init(worldState,_ref){var assets=_ref.assets,width=_ref.width,height=_ref.height;var atlas=assets.newAssets;combo1=atlas.findRegion(\"combo1\",-1);combo2=atlas.findRegion(\"combo2\",-1);combo3=atlas.findRegion(\"combo3\",-1);var C1_WIDTH=width/3;var C1_HEIGHT=C1_WIDTH*combo1.height/combo1.width;var C2_WIDTH=width/2.5;var C2_HEIGHT=C2_WIDTH*combo2.height/combo2.width;var C3_WIDTH=width/2;var C3_HEIGHT=C3_WIDTH*combo3.height/combo3.width;comboSize=[{width:C1_WIDTH,height:C1_HEIGHT},{width:C2_WIDTH,height:C2_HEIGHT},{width:C3_WIDTH,height:C3_HEIGHT}];},update:function update(delta,worldState,_ref2){var batch=_ref2.batch,camera=_ref2.camera,width=_ref2.width,height=_ref2.height;var comboCounter=worldState.comboCounter,comboState=worldState.comboState;if(comboCounter===10&&worldState.comboCheckIndex[comboCounter]===undefined){worldState.comboCheckIndex[comboCounter]=true;pushToComboList(comboList,combo1,0,comboSize,width,height);}else if(comboCounter===30&&worldState.comboCheckIndex[comboCounter]===undefined){worldState.comboCheckIndex[comboCounter]=true;pushToComboList(comboList,combo2,1,comboSize,width,height);}else if(comboCounter>=50&&comboCounter%10===0&&worldState.comboCheckIndex[comboCounter]===undefined){worldState.comboCheckIndex[comboCounter]=true;pushToComboList(comboList,combo3,2,comboSize,width,height);}batch.setProjection(camera.combined);batch.begin();for(var i=comboList.length-1;i>=0;i--){batch.setColor(1,1,1,comboList[i].infos.opacity);comboList[i].tex.draw(batch,comboList[i].x-comboList[i].width/2,comboList[i].y,comboList[i].width,comboList[i].height,comboList[i].width/2,comboList[i].height/2,0,comboList[i].infos.scale,comboList[i].infos.scale);if(comboList[i].infos.scale<1&&comboList[i].infos.stateTime===0){comboList[i].infos.scale=Math.min(comboList[i].infos.scale+=delta*comboState.scaleSpeed,1);comboList[i].infos.opacity=Math.min(comboList[i].infos.opacity+=delta*comboState.opacitySpeed,1);}else{comboList[i].infos.stateTime+=delta;if(comboList[i].infos.stateTime>comboState.delayTime){comboList[i].infos.scale=Math.max(comboList[i].infos.scale-=delta*comboState.scaleSpeed,0);comboList[i].infos.opacity=Math.max(comboList[i].infos.opacity-=delta*comboState.opacitySpeed,0);if(comboList[i].infos.scale===0){comboList.splice(i,1);}}}}batch.end();}};};export default createBannerComboRenderSystem;","map":{"version":3,"sources":["E:/fcatcher-client/src/components/game/systems/BannerComboRenderSystem.js"],"names":["pushToComboList","comboList","texture","indexCombo","comboSize","width","height","push","tex","x","Math","random","y","infos","stateTime","scale","opacity","createBannerComboRenderSystem","combo1","combo2","combo3","init","worldState","assets","atlas","newAssets","findRegion","C1_WIDTH","C1_HEIGHT","C2_WIDTH","C2_HEIGHT","C3_WIDTH","C3_HEIGHT","update","delta","batch","camera","comboCounter","comboState","comboCheckIndex","undefined","setProjection","combined","begin","i","length","setColor","draw","min","scaleSpeed","opacitySpeed","delayTime","max","splice","end"],"mappings":"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","sourcesContent":["const pushToComboList = (\r\n  comboList,\r\n  texture,\r\n  indexCombo,\r\n  comboSize,\r\n  width,\r\n  height\r\n) => {\r\n  comboList.push({\r\n    tex: texture,\r\n    x: Math.random() > 0.5 ? (width * 1.5) / 4 : (width * 2.5) / 4,\r\n    y:\r\n      Math.random() * ((height * 2) / 4 - (height * 2.5) / 4) +\r\n      (height * 2.5) / 4,\r\n    width: comboSize[indexCombo].width,\r\n    height: comboSize[indexCombo].height,\r\n    infos: { stateTime: 0, scale: 0, opacity: 0 },\r\n  });\r\n};\r\n\r\nconst createBannerComboRenderSystem = () => {\r\n  let comboList = [];\r\n  let combo1, combo2, combo3;\r\n  let comboSize = [];\r\n\r\n  return {\r\n    init(worldState, { assets, width, height }) {\r\n      const atlas = assets.newAssets;\r\n\r\n      combo1 = atlas.findRegion(\"combo1\", -1);\r\n      combo2 = atlas.findRegion(\"combo2\", -1);\r\n      combo3 = atlas.findRegion(\"combo3\", -1);\r\n\r\n      const C1_WIDTH = width / 3;\r\n      const C1_HEIGHT = (C1_WIDTH * combo1.height) / combo1.width;\r\n\r\n      const C2_WIDTH = width / 2.5;\r\n      const C2_HEIGHT = (C2_WIDTH * combo2.height) / combo2.width;\r\n\r\n      const C3_WIDTH = width / 2;\r\n      const C3_HEIGHT = (C3_WIDTH * combo3.height) / combo3.width;\r\n      comboSize = [\r\n        { width: C1_WIDTH, height: C1_HEIGHT },\r\n        { width: C2_WIDTH, height: C2_HEIGHT },\r\n        { width: C3_WIDTH, height: C3_HEIGHT },\r\n      ];\r\n    },\r\n    update(delta, worldState, { batch, camera, width, height }) {\r\n      const { comboCounter, comboState } = worldState;\r\n      if (\r\n        comboCounter === 10 &&\r\n        worldState.comboCheckIndex[comboCounter] === undefined\r\n      ) {\r\n        worldState.comboCheckIndex[comboCounter] = true;\r\n        pushToComboList(comboList, combo1, 0, comboSize, width, height);\r\n      } else if (\r\n        comboCounter === 30 &&\r\n        worldState.comboCheckIndex[comboCounter] === undefined\r\n      ) {\r\n        worldState.comboCheckIndex[comboCounter] = true;\r\n        pushToComboList(comboList, combo2, 1, comboSize, width, height);\r\n      } else if (\r\n        comboCounter >= 50 &&\r\n        comboCounter % 10 === 0 &&\r\n        worldState.comboCheckIndex[comboCounter] === undefined\r\n      ) {\r\n        worldState.comboCheckIndex[comboCounter] = true;\r\n        pushToComboList(comboList, combo3, 2, comboSize, width, height);\r\n      }\r\n\r\n      batch.setProjection(camera.combined);\r\n      batch.begin();\r\n      for (let i = comboList.length - 1; i >= 0; i--) {\r\n        batch.setColor(1, 1, 1, comboList[i].infos.opacity);\r\n        comboList[i].tex.draw(\r\n          batch,\r\n          comboList[i].x - comboList[i].width / 2,\r\n          comboList[i].y,\r\n          comboList[i].width,\r\n          comboList[i].height,\r\n          comboList[i].width / 2,\r\n          comboList[i].height / 2,\r\n          0,\r\n          comboList[i].infos.scale,\r\n          comboList[i].infos.scale\r\n        );\r\n\r\n        if (\r\n          comboList[i].infos.scale < 1 &&\r\n          comboList[i].infos.stateTime === 0\r\n        ) {\r\n          comboList[i].infos.scale = Math.min(\r\n            (comboList[i].infos.scale += delta * comboState.scaleSpeed),\r\n            1\r\n          );\r\n          comboList[i].infos.opacity = Math.min(\r\n            (comboList[i].infos.opacity += delta * comboState.opacitySpeed),\r\n            1\r\n          );\r\n        } else {\r\n          comboList[i].infos.stateTime += delta;\r\n          if (comboList[i].infos.stateTime > comboState.delayTime) {\r\n            comboList[i].infos.scale = Math.max(\r\n              (comboList[i].infos.scale -= delta * comboState.scaleSpeed),\r\n              0\r\n            );\r\n            comboList[i].infos.opacity = Math.max(\r\n              (comboList[i].infos.opacity -= delta * comboState.opacitySpeed),\r\n              0\r\n            );\r\n\r\n            if (comboList[i].infos.scale === 0) {\r\n              comboList.splice(i, 1);\r\n            }\r\n          }\r\n        }\r\n      }\r\n      batch.end();\r\n    },\r\n  };\r\n};\r\n\r\nexport default createBannerComboRenderSystem;\r\n"]},"metadata":{},"sourceType":"module"}