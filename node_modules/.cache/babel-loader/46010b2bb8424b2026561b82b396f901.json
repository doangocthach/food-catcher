{"ast":null,"code":"import \"./index.css\";\nimport { createGameLoop, createBatch, loadTexture, loadAtlas, createViewport, fillRect } from \"gdxjs\";\nimport createWhiteText from \"gl-white-texture\";\nimport loadFontFile from \"./utils/loadFontFile\";\nimport createStartScreenSystem from \"./StartScreen\";\n\nconst init = async (canvas, infos) => {\n  const width = 47;\n  const height = 100;\n  const viewport = createViewport(canvas, width, height);\n  const camera = viewport.getCamera();\n  const gl = viewport.getContext();\n  const batch = createBatch(gl);\n  const whiteTex = createWhiteText(gl);\n  const Game = {\n    score: 0,\n    width,\n    height,\n    canvas,\n    gl,\n    batch,\n    camera,\n    whiteTex,\n    viewport,\n\n    setCurrentScreen(screen) {\n      if (Game.currentScreen) {\n        Game.currentScreen.destroy();\n      }\n\n      Game.currentScreen = screen;\n    }\n\n  };\n  let counter = 0;\n  const numOfAssets = 10;\n  let time = Date.now();\n\n  const draw = () => {\n    console.log(counter, (Date.now() - time) / 1000);\n    time = Date.now() / 1000;\n    camera.setPosition(0, 0);\n    batch.setProjection(camera.combined);\n    batch.begin();\n    batch.setColor(255 / 255, 114 / 255, 22 / 255, 1);\n    fillRect(batch, whiteTex, 0, 0, width, height);\n    batch.setColor(1, 1, 1, 1);\n    fillRect(batch, whiteTex, width / 2 - width / (1.45 * 2), height * 2.5 / 4 - height / 50, width / 1.45, height / 25);\n    batch.setColor(255 / 255, 114 / 255, 22 / 255, 1);\n    fillRect(batch, whiteTex, width / 2 - width / 3, height * 2.5 / 4 - height / 60, width / 1.5, height / 30);\n    batch.setColor(1, 1, 1, 1);\n    let ratio = counter / numOfAssets;\n    fillRect(batch, whiteTex, width / 2 - width / (1.55 * 2), height * 2.5 / 4 - height / 80, width / 1.55 * ratio, height / 40);\n    batch.end();\n  };\n\n  const doAndCount = promise => promise.then(result => {\n    draw();\n    counter += 1;\n    return result;\n  });\n\n  const [gameAssets, animAssets, backGround, newAssets, foodInPot, startScreen, backGround2, leaderBoard, numberFont, textFont] = await Promise.all([doAndCount(loadAtlas(gl, \"./assets/food_catch.atlas\")), doAndCount(loadAtlas(gl, \"./assets/hotpot.atlas\")), doAndCount(loadTexture(gl, \"./assets/bg.jpg\")), doAndCount(loadAtlas(gl, \"./assets/hotpot-additional.atlas\")), doAndCount(loadAtlas(gl, \"./assets/foodinhotpot.atlas\")), doAndCount(loadAtlas(gl, \"./assets/start_menu.atlas\")), doAndCount(loadTexture(gl, \"./assets/bbg-start.jpg\")), doAndCount(loadAtlas(gl, \"./assets/leaderBoard.atlas\")), doAndCount(loadFontFile(gl, \"./fonts/iciel-64.fnt\")), doAndCount(loadFontFile(gl, \"./fonts/mijas.fnt\"))]);\n  let assets = {\n    gameAssets,\n    animAssets,\n    backGround,\n    newAssets,\n    foodInPot,\n    startScreen,\n    backGround2,\n    leaderBoard\n  };\n  Game.assets = assets;\n  Game.font = {\n    numberFont,\n    textFont\n  };\n  Game.setCurrentScreen(await createStartScreenSystem(Game));\n  gl.clearColor(255 / 255, 114 / 255, 22 / 255, 1);\n\n  const update = delta => {\n    gl.clear(gl.COLOR_BUFFER_BIT);\n\n    if (Game.currentScreen) {\n      Game.currentScreen.update(delta);\n    }\n  };\n\n  const newGame = createGameLoop(update);\n  setInterval(() => {\n    infos.innerText = newGame.getFps();\n  }, 1000);\n};\n\nexport default init;","map":{"version":3,"sources":["E:/fcatcher-client/src/components/game/index.js"],"names":["createGameLoop","createBatch","loadTexture","loadAtlas","createViewport","fillRect","createWhiteText","loadFontFile","createStartScreenSystem","init","canvas","infos","width","height","viewport","camera","getCamera","gl","getContext","batch","whiteTex","Game","score","setCurrentScreen","screen","currentScreen","destroy","counter","numOfAssets","time","Date","now","draw","console","log","setPosition","setProjection","combined","begin","setColor","ratio","end","doAndCount","promise","then","result","gameAssets","animAssets","backGround","newAssets","foodInPot","startScreen","backGround2","leaderBoard","numberFont","textFont","Promise","all","assets","font","clearColor","update","delta","clear","COLOR_BUFFER_BIT","newGame","setInterval","innerText","getFps"],"mappings":"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","sourcesContent":["import \"./index.css\";\r\nimport {\r\n  createGameLoop,\r\n  createBatch,\r\n  loadTexture,\r\n  loadAtlas,\r\n  createViewport,\r\n  fillRect,\r\n} from \"gdxjs\";\r\nimport createWhiteText from \"gl-white-texture\";\r\nimport loadFontFile from \"./utils/loadFontFile\";\r\n\r\nimport createStartScreenSystem from \"./StartScreen\";\r\n\r\nconst init = async (canvas, infos) => {\r\n  const width = 47;\r\n  const height = 100;\r\n  const viewport = createViewport(canvas, width, height);\r\n  const camera = viewport.getCamera();\r\n  const gl = viewport.getContext();\r\n  const batch = createBatch(gl);\r\n  const whiteTex = createWhiteText(gl);\r\n\r\n  const Game = {\r\n    score: 0,\r\n    width,\r\n    height,\r\n    canvas,\r\n    gl,\r\n    batch,\r\n    camera,\r\n    whiteTex,\r\n    viewport,\r\n    setCurrentScreen(screen) {\r\n      if (Game.currentScreen) {\r\n        Game.currentScreen.destroy();\r\n      }\r\n      Game.currentScreen = screen;\r\n    },\r\n  };\r\n  let counter = 0;\r\n  const numOfAssets = 10;\r\n\r\n  let time = Date.now();\r\n  const draw = () => {\r\n    console.log(counter, (Date.now() - time) / 1000);\r\n    time = Date.now() / 1000;\r\n    camera.setPosition(0, 0);\r\n    batch.setProjection(camera.combined);\r\n    batch.begin();\r\n    batch.setColor(255 / 255, 114 / 255, 22 / 255, 1);\r\n    fillRect(batch, whiteTex, 0, 0, width, height);\r\n    batch.setColor(1, 1, 1, 1);\r\n    fillRect(\r\n      batch,\r\n      whiteTex,\r\n      width / 2 - width / (1.45 * 2),\r\n      (height * 2.5) / 4 - height / 50,\r\n      width / 1.45,\r\n      height / 25\r\n    );\r\n    batch.setColor(255 / 255, 114 / 255, 22 / 255, 1);\r\n    fillRect(\r\n      batch,\r\n      whiteTex,\r\n      width / 2 - width / 3,\r\n      (height * 2.5) / 4 - height / 60,\r\n      width / 1.5,\r\n      height / 30\r\n    );\r\n    batch.setColor(1, 1, 1, 1);\r\n    let ratio = counter / numOfAssets;\r\n    fillRect(\r\n      batch,\r\n      whiteTex,\r\n      width / 2 - width / (1.55 * 2),\r\n      (height * 2.5) / 4 - height / 80,\r\n      (width / 1.55) * ratio,\r\n      height / 40\r\n    );\r\n    batch.end();\r\n  };\r\n\r\n  const doAndCount = (promise) =>\r\n    promise.then((result) => {\r\n      draw();\r\n      counter += 1;\r\n      return result;\r\n    });\r\n\r\n  const [\r\n    gameAssets,\r\n    animAssets,\r\n    backGround,\r\n    newAssets,\r\n    foodInPot,\r\n    startScreen,\r\n    backGround2,\r\n    leaderBoard,\r\n    numberFont,\r\n    textFont,\r\n  ] = await Promise.all([\r\n    doAndCount(loadAtlas(gl, \"./assets/food_catch.atlas\")),\r\n    doAndCount(loadAtlas(gl, \"./assets/hotpot.atlas\")),\r\n    doAndCount(loadTexture(gl, \"./assets/bg.jpg\")),\r\n    doAndCount(loadAtlas(gl, \"./assets/hotpot-additional.atlas\")),\r\n    doAndCount(loadAtlas(gl, \"./assets/foodinhotpot.atlas\")),\r\n    doAndCount(loadAtlas(gl, \"./assets/start_menu.atlas\")),\r\n    doAndCount(loadTexture(gl, \"./assets/bbg-start.jpg\")),\r\n    doAndCount(loadAtlas(gl, \"./assets/leaderBoard.atlas\")),\r\n    doAndCount(loadFontFile(gl, \"./fonts/iciel-64.fnt\")),\r\n    doAndCount(loadFontFile(gl, \"./fonts/mijas.fnt\")),\r\n  ]);\r\n\r\n  let assets = {\r\n    gameAssets,\r\n    animAssets,\r\n    backGround,\r\n    newAssets,\r\n    foodInPot,\r\n    startScreen,\r\n    backGround2,\r\n    leaderBoard,\r\n  };\r\n  Game.assets = assets;\r\n\r\n  Game.font = { numberFont, textFont };\r\n  Game.setCurrentScreen(await createStartScreenSystem(Game));\r\n\r\n  gl.clearColor(255 / 255, 114 / 255, 22 / 255, 1);\r\n  const update = (delta) => {\r\n    gl.clear(gl.COLOR_BUFFER_BIT);\r\n\r\n    if (Game.currentScreen) {\r\n      Game.currentScreen.update(delta);\r\n    }\r\n  };\r\n\r\n  const newGame = createGameLoop(update);\r\n\r\n  setInterval(() => {\r\n    infos.innerText = newGame.getFps();\r\n  }, 1000);\r\n};\r\n\r\nexport default init;\r\n"]},"metadata":{},"sourceType":"module"}